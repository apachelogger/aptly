sudo: false

language: go

go:
  - 1.6

addons:
  apt:
    packages:
    - python-virtualenv
    - graphviz

env:
  global:
    - secure: "YSwtFrMqh4oUvdSQTXBXMHHLWeQgyNEL23ChIZwU0nuDGIcQZ65kipu0PzefedtUbK4ieC065YCUi4UDDh6gPotB/Wu1pnYg3dyQ7rFvhaVYAAUEpajAdXZhlx+7+J8a4FZMeC/kqiahxoRgLbthF9019ouIqhGB9zHKI6/yZwc="
    - secure: "V7OjWrfQ8UbktgT036jYQPb/7GJT3Ol9LObDr8FYlzsQ+F1uj2wLac6ePuxcOS4FwWOJinWGM1h+JiFkbxbyFqfRNJ0jj0O2p93QyDojxFVOn1mXqqvV66KFqAWR2Vzkny/gDvj8LTvdB1cgAIm2FNOkQc6E1BFnyWS2sN9ea5E="
    - secure: "OxiVNmre2JzUszwPNNilKDgIqtfX2gnRSsVz6nuySB1uO2yQsOQmKWJ9cVYgH2IB5H8eWXKOhexcSE28kz6TPLRuEcU9fnqKY3uEkdwm7rJfz9lf+7C4bJEUdA1OIzJppjnWUiXxD7CEPL1DlnMZM24eDQYqa/4WKACAgkK53gE="
before_install:
  - git config user.email "sitter@kde.org"
  - git config user.name "Blue Systems Travis Builder"
  #- git fetch -v origin sftp:sftp
  #- git merge -v sftp -m 'automerge'
  - ln -s $GOPATH/src/github.com/apachelogger $GOPATH/src/github.com/smira
  - virtualenv env
  - . env/bin/activate
  - pip install --upgrade setuptools
  - pip install boto requests python-swiftclient sftpserver
install:
  - make prepare
  - ssh-keygen -t rsa -q -P "" -f /home/travis/.ssh/id_rsa


script: make travis

matrix:
    allow_failures:
        - go: tip

branches:
  only:
  - blue-systems


notifications:
  email:
    on_success: change # default: change
    on_failure: change # default: always

deploy:
  provider: releases
  api_key:
    secure: OdJySdlZtq5Ia17h/KsateCJ/mASRXb1+Vs2aTTfS92AM2Zzv7+SMVVM4fEaFXeWkehieC/iuY55cm9E9mgLo+gaDrhIl+TJmhJiNyN7IwR254OX7n3HpTky48LRQilxctuc7N+JrJcb3eoFflaNat0QpyjWyOeuoQoksqxsg9j/HzcEB6NkxkRqdmmXVQIfZGontW973QwBU9133i1YRjno9GwoqRNHvCWrN9zwVONpf6NxomExTAH9ngZeOk5lYWrpVw7hrrsKfWz03eIURjibOucnk4ug1arZs+vaFbGQP+avaG/Ac6JESfB/Qz+EsMdhejTtOvDYHM0CGdJ8tjCNkPbt4WpNd7I+AwOh4PcIjo8cv/a72bKGNu3NIDTPiOOIkqlylb1In7cHvQk1x5xA6w9iIErUIum9g09BnkZOYAEAop2F3UCB4nS6YBN9NI/TR04DZHb/+q9Heh7PnZio91VPlH9aEPYS9XlWHRpD/70psxGz3dxzeracKbv6Vq8LFxWVL2hJZz+X+r5lOQIbcQRkfQAQZWdJT/DM4QIyKBzBV7J/BGc4hkgkk+daxG/2XNb9Sd5nyxpbQlgu9Bd8Gv8vHAGdYLv1tEZn/Oj9Ibol8CJfBA2mXcEI8nOxE6HNwfqBot0CfCb/GqacjC6j4HvY917byki6qD7K6v8=
  file: pub/aptly
  skip_cleanup: true
  on:
    repo: apachelogger/aptly
    branch: blue-systems
